 This simulation code package is mainly used to reproduce the results of the following paper [1]:

[1] D. Shen and L. Dai, "Multi-Beam Design for Extremely Large-Scale RIS Aided Near-Field Wireless Communications," GLOBECOM 2022 - 2022 IEEE Global Communications Conference, Rio de Janeiro, Brazil, 2022, pp. 1-6. 

*********************************************************************************************************************************
If you use this simulation code package in any way, please cite the original paper [1] above. 
 
The author in charge of this simulation code pacakge is: Decai Shen (email: sdc18@mails.tsinghua.edu.cn).

Reference: We highly respect reproducible research, so we try to provide the simulation codes for our published papers (more information can be found at: 
http://oa.ee.tsinghua.edu.cn/dailinglong/publications/publications.html). 

Please note that the MATLAB R2020a is used for this simulation code package,  and there may be some imcompatibility problems among different MATLAB versions. 

Copyright reserved by the Broadband Communications and Signal Processing Laboratory (led by Dr. Linglong Dai), Beijing National Research Center for Information Science and Technology (BNRist), Department of Electronic Engineering, Tsinghua University, Beijing 100084, China. 
*********************************************************************************************************************************
Abstract of the paper: The development of reconfigurable intelligent surface (RIS) will evolve towards the extremely large-scale RIS (XL-RIS) to overcome the “multiplicative fading effect”. With the increase in array aperture, this evolution leads to the near-field propagation becoming dominant. To achieve the performance gain of XL-RIS, it is effective to explore the near-field beam design with a codebook via beam training. Unfortunately, due to the constant modulus constraint of XL-RIS, most of the existing works in the near-field scenario focus on single-beam design. Hence, these works will face a serious loss for the quality of service in the multiple user equipments case. In this paper, we propose a block coordinate descent (BCD) based scheme with majorization-minimization (MM) algorithm for the multi-beam design. The proposed scheme handles the constant modulus constraint from two aspects. Firstly, the multi-beam design is an intractable non-convex quadratic programming problem due to this constraint. We utilize the MM algorithm to decompose this problem as a series of tractable sub-problems to be iteratively solved. Secondly, the solution space for the multi-beam design is limited due to this constraint, we introduce the phases for beam gains as an extra optimizable variable to enrich the degree of freedom for optimization. Simulation results show that the proposed multi-beam design can achieve a superior quality of service 50% higher than the existing schemes.


*********************************************************************************************************************************
How to use this simulation code package?

All figures can be generated by running the corresponding .m file.

For example, you can generate the Figure 4 by running FIG4.m.

p.s. All the codes of this paper are supported by "parfor" structure of Matlab to  improve the computing speed. If your PC does not support it, just revise the "parfor" as "for" in the codes of the main function.
*********************************************************************************************************************************
Enjoy the reproducible research!


p.s.：
In order to get a smooth curve, this code tends to run for a long time (Seveal hours or longer, in the parfor structure)